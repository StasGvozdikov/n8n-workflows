{
  "name": "Personalized Email Campaign (FortiMail)",
  "nodes": [
    {
      "parameters": {},
      "id": "2781b033-0c4c-4e8c-8438-b71553c713b5",
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        -20,
        240
      ]
    },
    {
      "parameters": {
        "documentId": "",
        "sheetName": "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ",
        "options": {
          "asJson": true
        }
      },
      "id": "e7264a40-e55c-4d39-9d97-1755177264cc",
      "name": "Read Contacts",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        200,
        240
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "batchSize": 20,
        "options": {
          "reset": false
        }
      },
      "id": "017a0752-62b2-4d2d-94c6-e673413554b2",
      "name": "Split into Batches (20)",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 2,
      "position": [
        420,
        240
      ]
    },
    {
      "parameters": {
        "model": "gemini-pro",
        "prompt": "–¢–∏ ‚Äî –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–Ω–∏–∫ –î–ü \"–ù–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π —ñ–Ω—Å—Ç–∏—Ç—É—Ç —Ä–æ–∑–≤–∏—Ç–∫—É —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏\". –¢–≤–æ—î –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî –≤–∑—è—Ç–∏ —ñ–º'—è —Ç–∞ –ø–æ-–±–∞—Ç—å–∫–æ–≤—ñ –ª—é–¥–∏–Ω–∏ —ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –π–æ–≥–æ –Ω–∞ –∫–ª–∏—á–Ω–∏–π –≤—ñ–¥–º—ñ–Ω–æ–∫ –¥–ª—è –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤ –ª–∏—Å—Ç—ñ.\n\n–û—Å—å –ø–æ–≤–Ω–µ —ñ–º'—è: {{ $json[\"–ü–Ü–ë\"] }}\n\n–î–∞–π –≤—ñ–¥–ø–æ–≤—ñ–¥—å, —â–æ –º—ñ—Å—Ç–∏—Ç—å –¢–Ü–õ–¨–ö–ò –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —ñ–º'—è \"–ú–∞–∑—É—Ä –Ø—Ä–æ—Å–ª–∞–≤ –í—ñ–∫—Ç–æ—Ä–æ–≤–∏—á\", —Ç–≤–æ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º–∞—î –±—É—Ç–∏ \"–Ø—Ä–æ—Å–ª–∞–≤–µ –í—ñ–∫—Ç–æ—Ä–æ–≤–∏—á—É\".\n\n–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤—ñ–∑—å–º–∏ –≥–æ—Ç–æ–≤–∏–π —à–∞–±–ª–æ–Ω –ª–∏—Å—Ç–∞ —ñ –≤—Å—Ç–∞–≤ —Ü–µ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –Ω–∞ –ø–æ—á–∞—Ç–∫—É.\n\n–®–∞–±–ª–æ–Ω –ª–∏—Å—Ç–∞:\n\"–í—ñ—Ç–∞—é, [–Ü–º'—è —Ç–∞ –ø–æ-–±–∞—Ç—å–∫–æ–≤—ñ]!\n–ó–∞–ø—Ä–æ—à—É—î–º–æ –≤–∞—Å –Ω–∞ –≤–∞–∂–ª–∏–≤–∏–π –ø—Ä–∞–∫—Ç–∏—á–Ω–∏–π –≤–µ–±—ñ–Ω–∞—Ä, –ø—Ä–∏—Å–≤—è—á–µ–Ω–∏–π —Ä–æ–±–æ—Ç—ñ –∑ –Ü–ê–° \"–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ü—ñ–Ω\" –≤ —É–º–æ–≤–∞—Ö –Ω–æ–≤–∏—Ö –≤–∏–º–æ–≥ –¥–æ –ø—Ä–æ–∑–æ—Ä–æ—Å—Ç—ñ –≤—ñ–¥–±—É–¥–æ–≤–∏. –†–∞–∑–æ–º –∑ –µ–∫—Å–ø–µ—Ä—Ç–∞–º–∏ YouControl –º–∏ —Ä–æ–∑–±–µ—Ä–µ–º–æ, —è–∫ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤, —É–Ω–∏–∫–∞—Ç–∏ —Ä–∏–∑–∏–∫—ñ–≤ –∑–∞–≤–∏—â–µ–Ω–Ω—è —Ü—ñ–Ω —Ç–∞ –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ –±—é–¥–∂–µ—Ç–Ω—ñ –∫–æ—à—Ç–∏.\n–†–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥—ñ—î–≤—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö: https://www.youcontrol.events/yc-baza-cin-niri-16-10\n–¢–∞–∫–æ–∂ –º–∞—î–º–æ –≤–∞–∂–ª–∏–≤–µ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è: –∑–∞–≤—Ç—Ä–∞, 10 –∂–æ–≤—Ç–Ω—è, ‚Äî –∫—Ä–∞–π–Ω—ñ–π –¥–µ–Ω—å –¥–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –≤–∞—Ä—Ç—ñ—Å—Ç—å –±—É–¥—ñ–≤–µ–ª—å–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑–∞ –≤–µ—Ä–µ—Å–µ–Ω—å 2025 —Ä–æ–∫—É. –°–≤–æ—î—á–∞—Å–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —î –∫–ª—é—á–æ–≤–∏–º –¥–ª—è –ø—Ä–æ–∑–æ—Ä–æ—Å—Ç—ñ —Ç–∞ —Ç–æ—á–Ω–æ—Å—Ç—ñ –∫–æ—à—Ç–æ—Ä–∏—Å—ñ–≤. –ë—É–¥—å –ª–∞—Å–∫–∞, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—Å—ñ –¥–∞–Ω—ñ –≤–Ω–µ—Å–µ–Ω–æ –∫–æ—Ä–µ–∫—Ç–Ω–æ: https://prices.restoration.gov.ua\nüí° –í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏ –¥–æ –±–∞–∑–∏!\n–ù–∞–¥—Å–∏–ª–∞–π—Ç–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–Ω–∞–∑–≤—É, –≤–∞—Ä—Ç—ñ—Å—Ç—å, –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞, –¥–∂–µ—Ä–µ–ª–æ) –Ω–∞ nauka@nidi.org.ua –Ω–∞ —ñ–º'—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –î–ü \"–ù–Ü–†–Ü\" –ê—Ä—Ç–µ–º–∞ –ë–µ–∑—É–≥–ª–æ–≥–æ. –£ —Ç–µ–º—ñ –ª–∏—Å—Ç–∞ –∑–∞–∑–Ω–∞—á—Ç–µ: –Ü–ê–° \"–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ü—ñ–Ω\": –Ω–æ–≤–∏–π —Ä–µ—Å—É—Ä—Å.\n–Ø–∫—â–æ –≤–∏–Ω–∏–∫–∞—é—Ç—å –ø–∏—Ç–∞–Ω–Ω—è, –Ω–∞—à–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –Ω–∞ –∑–≤'—è–∑–∫—É:\n* WhatsApp:(https://chat.whatsapp.com/HohrpRT3ytv5KYQeDopbXv)\n* Telegram: @price_data\n–Ü –Ω–∞–æ—Å—Ç–∞–Ω–æ–∫, –ø—Ä–æ–ø–æ–Ω—É—î–º–æ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∑–≤–µ–¥–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö –ø–æ–¥—ñ–π —Ç–∞ –∞–Ω–æ–Ω—Å—ñ–≤, —â–æ–± –≤–∏ —Ç—Ä–∏–º–∞–ª–∏ —Ä—É–∫—É –Ω–∞ –ø—É–ª—å—Å—ñ –≥–∞–ª—É–∑—ñ –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –≤ Telegram: https://t.me/idvlpmnt ( @idvlpmnt ) –∞–±–æ –Ω–∞ —Å–∞–π—Ç—ñ: https://nidi.org.ua/ua/novini\n–î—è–∫—É—î–º–æ –∑–∞ –≤–∞—à—É —Å–ø—ñ–≤–ø—Ä–∞—Ü—é!\n–ó –ø–æ–≤–∞–≥–æ—é,\n–ó–∞—Å—Ç—É–ø–Ω–∏–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –∑ —î–≤—Ä–æ—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó\n–°—Ç–∞–Ω—ñ—Å–ª–∞–≤ –ì–≤–æ–∑–¥—ñ–∫–æ–≤\ns.gvozdikov@nidi.org.ua\n+380631116060\""
      },
      "id": "e158671f-e9b4-4b52-b89a-0d6037b3f46f",
      "name": "Generate Personalized Email",
      "type": "n8n-nodes-base.googleGemini",
      "typeVersion": 1,
      "position": [
        640,
        240
      ],
      "credentials": {
        "googleGeminiApi": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $('Generate Personalized Email').json.candidates[0].content.parts[0].text }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "4e73f443-42e1-4569-804d-e970a09e0a8d",
      "name": "Check if AI worked",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        860,
        240
      ]
    },
    {
      "parameters": {
        "fromName": "–°—Ç–∞–Ω—ñ—Å–ª–∞–≤ –ì–≤–æ–∑–¥—ñ–∫–æ–≤, –î–ü \"–ù–Ü–†–Ü\"",
        "fromEmail": "s.gvozdikov@nidi.org.ua",
        "to": "={{ $json[\"–õ–æ–≥—ñ–Ω\"] }}",
        "subject": "–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è –Ω–∞ –≤–µ–±—ñ–Ω–∞—Ä —Ç–∞ –≤–∞–∂–ª–∏–≤–µ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø–æ –Ü–ê–° \"–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ü—ñ–Ω\"",
        "html": "={{ $('Generate Personalized Email').json.candidates[0].content.parts[0].text.replace(/\\n/g, \"<br>\") }}"
      },
      "id": "f5e9a4f4-5b48-430b-9b4e-d069a19c6328",
      "name": "Send Email (SMTP)",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 3,
      "position": [
        1080,
        140
      ],
      "credentials": {
        "smtp": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "documentId": "={{ $('Read Contacts').params.documentId }}",
        "sheetName": "={{ $('Read Contacts').params.sheetName }}",
        "operation": "update",
        "key": "–õ–æ–≥—ñ–Ω",
        "keyValue": "={{ $json[\"–õ–æ–≥—ñ–Ω\"] }}",
        "fields": {
          "updateValues": [
            {
              "columnName": "–°—Ç–∞—Ç—É—Å –≤—ñ–¥–ø—Ä–∞–≤–∫–∏",
              "value": "–ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–µ–∫—Å—Ç—É AI"
            }
          ]
        }
      },
      "id": "e67e9b0b-71a2-4752-b13c-c90d0b0b8c54",
      "name": "Log Error",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        1080,
        340
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "={{ $('Read Contacts').credentials.googleSheetsOAuth2Api.id }}",
          "name": "={{ $('Read Contacts').credentials.googleSheetsOAuth2Api.name }}"
        }
      }
    },
    {
      "parameters": {
        "value": 1,
        "unit": "minutes"
      },
      "id": "c92842e4-c155-4675-9252-05459344465d",
      "name": "Wait 1 Minute",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 2,
      "position": [
        1300,
        140
      ]
    },
    {
      "parameters": {
        "documentId": "={{ $('Read Contacts').params.documentId }}",
        "sheetName": "={{ $('Read Contacts').params.sheetName }}",
        "operation": "update",
        "key": "–õ–æ–≥—ñ–Ω",
        "keyValue": "={{ $json[\"–õ–æ–≥—ñ–Ω\"] }}",
        "fields": {
          "updateValues": [
            {
              "columnName": "–°—Ç–∞—Ç—É—Å –≤—ñ–¥–ø—Ä–∞–≤–∫–∏",
              "value": "–ù–∞–¥—ñ—Å–ª–∞–Ω–æ"
            },
            {
              "columnName": "–î–∞—Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏",
              "value": "={{ new Date().toISOString() }}"
            }
          ]
        }
      },
      "id": "d044237f-59e5-4d7a-85d7-e04743e49876",
      "name": "Update Status to 'Sent'",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        1520,
        140
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "={{ $('Read Contacts').credentials.googleSheetsOAuth2Api.id }}",
          "name": "={{ $('Read Contacts').credentials.googleSheetsOAuth2Api.name }}"
        }
      }
    }
  ],
  "connections": {
    "Start": {
      "main": [
        [
          {
            "node": "Read Contacts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Contacts": {
      "main": [
        [
          {
            "node": "Split into Batches (20)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split into Batches (20)": {
      "main": [
        [
          {
            "node": "Generate Personalized Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Personalized Email": {
      "main": [
        [
          {
            "node": "Check if AI worked",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check if AI worked": {
      "main": [
        [
          {
            "node": "Send Email (SMTP)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Log Error",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Send Email (SMTP)": {
      "main": [
        [
          {
            "node": "Wait 1 Minute",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 1 Minute": {
      "main": [
        [
          {
            "node": "Update Status to 'Sent'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}
